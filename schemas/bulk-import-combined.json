{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://chronosgraph.com/schemas/bulk-import-combined.json",
  "title": "ChronosGraph Bulk Import Schema (Combined)",
  "description": "JSON schema for importing both historical figures and media works in a single file",
  "type": "object",
  "anyOf": [
    { "required": ["figures"] },
    { "required": ["media_works"] }
  ],
  "properties": {
    "metadata": {
      "type": "object",
      "properties": {
        "source": {
          "type": "string",
          "description": "Data source name"
        },
        "author": {
          "type": "string"
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$"
        }
      }
    },
    "figures": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["name"],
        "properties": {
          "name": { "type": "string", "minLength": 1, "maxLength": 200 },
          "wikidata_id": { "type": "string", "pattern": "^Q\\d+$" },
          "canonical_id": { "type": "string", "pattern": "^(Q\\d+|PROV:[a-z0-9_-]+)$" },
          "birth_year": { "type": "integer", "minimum": -3000, "maximum": 2100 },
          "death_year": { "type": "integer", "minimum": -3000, "maximum": 2100 },
          "era": { "type": "string", "maxLength": 100 },
          "title": { "type": "string", "maxLength": 200 },
          "occupation": { "type": "string", "maxLength": 200 },
          "description": { "type": "string", "maxLength": 1000 },
          "image_url": { "type": "string", "format": "uri" },
          "metadata": { "type": "object", "additionalProperties": true }
        },
        "additionalProperties": false
      }
    },
    "media_works": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["title", "media_type"],
        "properties": {
          "title": { "type": "string", "minLength": 1, "maxLength": 300 },
          "wikidata_id": { "type": "string", "pattern": "^Q\\d+$" },
          "media_id": { "type": "string" },
          "media_type": {
            "type": "string",
            "enum": [
              "Film", "TVSeries", "TVEpisode", "Book", "Novel", "Play", "Opera",
              "VideoGame", "BoardGame", "Podcast", "Documentary",
              "FilmSeries", "BookSeries", "TVSeriesCollection", "GameSeries", "BoardGameSeries"
            ]
          },
          "release_year": { "type": "integer", "minimum": 1400, "maximum": 2100 },
          "creator": { "type": "string", "maxLength": 300 },
          "genre": { "type": "string", "maxLength": 100 },
          "description": { "type": "string", "maxLength": 2000 },
          "runtime_minutes": { "type": "integer", "minimum": 1 },
          "portrayals": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["figure_identifier"],
              "properties": {
                "figure_identifier": { "type": "string" },
                "actor_name": { "type": "string", "maxLength": 200 },
                "character_name": { "type": "string", "maxLength": 200 },
                "is_protagonist": { "type": "boolean", "default": false },
                "sentiment": {
                  "type": "string",
                  "enum": ["heroic", "villainous", "neutral", "complex"],
                  "default": "neutral"
                },
                "screen_time_minutes": { "type": "integer", "minimum": 0 },
                "notes": { "type": "string", "maxLength": 500 }
              },
              "additionalProperties": false
            }
          },
          "metadata": { "type": "object", "additionalProperties": true }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
